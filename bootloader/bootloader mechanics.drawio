<mxfile host="app.diagrams.net" modified="2023-12-14T14:12:59.253Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36" version="22.1.7" etag="aoX5S9zKTFoB2TLa1p1f" type="google">
  <diagram name="Page-1" id="L8v-k4GA8zyhKXHsQq-C">
    <mxGraphModel grid="1" page="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-1" value="Bootloader&lt;br&gt;(32KB)" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="260" width="120" height="120" as="geometry" />
        </mxCell>
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-2" value="Flash Memory" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;" vertex="1" parent="1">
          <mxGeometry x="150" y="30" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-3" value="Application&lt;br&gt;(96KB)" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="80" y="100" width="120" height="160" as="geometry" />
        </mxCell>
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-5" value="0x08000000" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="110" y="360" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-10" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="50" y="100" width="20" height="280" as="geometry" />
        </mxCell>
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-9" value="0x0801FFFF" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="110" y="90" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-13" value="128 Kbyte" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;rotation=-90;" vertex="1" parent="1">
          <mxGeometry x="10" y="225" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-14" value="Interrupt Vector Table" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="250" y="240" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-15" value="Code and Data" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="250" y="100" width="120" height="140" as="geometry" />
        </mxCell>
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-16" value="Interrupt Vector Table" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="250" y="360" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-17" value="Code and Data" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="250" y="290" width="120" height="70" as="geometry" />
        </mxCell>
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-18" value="Padding" style="whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="250" y="260" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-19" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;endWidth=4.848484848484849;endSize=3.0181818181818185;fillColor=#d5e8d4;strokeColor=#82b366;startArrow=block;startWidth=4.848484848484849;startSize=3.0181818181818185;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="245" y="379.49" as="sourcePoint" />
            <mxPoint x="205" y="379.49" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ljWVKHkdT2M4jzvHkVH-20" value="&lt;font style=&quot;font-size: 6px;&quot;&gt;Entry Point&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" connectable="0" vertex="1" parent="6ljWVKHkdT2M4jzvHkVH-19">
          <mxGeometry x="0.0318" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-1" value="0x08007FFF" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="110" y="250" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-2" value="0x08008000" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="110" y="240" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-11" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;The IVT are different for both APP and BOOT. The IVT holds the address of the SP, reset handler, interrupt handlers needed by the Cortex M core. The handlers usually leads to a blocking handler, but can be implemented by user (with different behaviour in APP and BOOT).&amp;nbsp;&lt;/font&gt;&lt;br style=&quot;font-size: 8px;&quot;&gt;&lt;br style=&quot;font-size: 8px;&quot;&gt;Cortex M0 refers to a vector table in memory space 0x00000000, which in STM is mapped to FLASH (default), SRAM or System Memory. If APP is alligned to FLASH memory boundary, the Cortex will always refer to the correct IVT. But if BOOT exists before APP, then we need to inform Cortex of the offset for APP IVT. M3&amp;amp;4 allow us to change the VTOR in cortex registers directly, but not for M0.&lt;br style=&quot;font-size: 8px;&quot;&gt;&lt;br style=&quot;font-size: 8px;&quot;&gt;&lt;b style=&quot;font-size: 8px;&quot;&gt;We have to copy the IVT to SRAM and link SRAM to 0x00000000 through SYSCFG1_CFGR1[1:0]&lt;/b&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Verdana;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="410" y="190" width="440" height="100" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-12" value="BOOT SRAM (16KB)" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="440" y="75" width="370" height="30" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-13" value="APP SRAM (16KB - IVT )" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="500" y="135" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-15" value="IVT" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="440" y="135" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-18" value="Mutually Exclusive (no common memory region)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="480" y="105" width="262.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-19" value="" style="shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn0.iconfinder.com/data/icons/math-business-icon-set/93/1_9-128.png" vertex="1" parent="1">
          <mxGeometry x="440" y="175" width="10" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-20" value="Need to setup region in LinkerScript" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="450" y="175" width="170" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-21" value="SRAM" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;" vertex="1" parent="1">
          <mxGeometry x="550" y="30" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-22" value="Flow Overview" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;" vertex="1" parent="1">
          <mxGeometry x="260" y="440" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-23" value="" style="endArrow=none;dashed=1;html=1;rounded=0;exitX=0;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="QN8Zc_zHYGFrYNp_f-iq-15">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="410" y="55" as="sourcePoint" />
            <mxPoint x="440" y="65" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-24" value="" style="endArrow=none;dashed=1;html=1;rounded=0;exitX=0;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="809.31" y="135" as="sourcePoint" />
            <mxPoint x="809.31" y="65" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-25" value="0x20000000" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="410" y="45" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-26" value="0x20004000" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="780" y="45" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-27" value="" style="shape=trapezoid;perimeter=trapezoidPerimeter;whiteSpace=wrap;html=1;fixedSize=1;rotation=90;direction=west;size=8.75;" vertex="1" parent="1">
          <mxGeometry x="568.75" y="334.67" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-32" value="" style="endArrow=none;html=1;rounded=0;entryX=0.25;entryY=1;entryDx=0;entryDy=0;startArrow=classic;startFill=1;endFill=0;" edge="1" parent="1" target="QN8Zc_zHYGFrYNp_f-iq-27">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="680" y="359.67" as="sourcePoint" />
            <mxPoint x="543.75" y="309.67" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-33" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;startArrow=classic;startFill=1;endFill=0;" edge="1" parent="1" target="QN8Zc_zHYGFrYNp_f-iq-27">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="680" y="344.67" as="sourcePoint" />
            <mxPoint x="588.75" y="349.67" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-34" value="" style="endArrow=none;html=1;rounded=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;startArrow=classic;startFill=1;endFill=0;" edge="1" parent="1" target="QN8Zc_zHYGFrYNp_f-iq-27">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="680" y="329.67" as="sourcePoint" />
            <mxPoint x="573.75" y="359.67" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-35" value="" style="endArrow=none;html=1;rounded=0;startArrow=classic;startFill=1;endFill=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="QN8Zc_zHYGFrYNp_f-iq-27">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="581" y="344.57" as="sourcePoint" />
            <mxPoint x="520" y="344.67" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-36" value="0x00000000" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="520" y="334.67" width="60" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-40" value="0x08000000" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="610" y="320" width="60" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-41" value="0x20000000" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="610" y="334.67" width="60" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-42" value="0x1FFFC800" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="610" y="350" width="60" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-61" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="QN8Zc_zHYGFrYNp_f-iq-43" target="QN8Zc_zHYGFrYNp_f-iq-64">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="730" y="330" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-43" value="FLASH" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="680" y="324.67" width="30" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-66" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="QN8Zc_zHYGFrYNp_f-iq-44" target="QN8Zc_zHYGFrYNp_f-iq-65">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-44" value="SRAM" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="680" y="340" width="30" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-45" value="System Memory" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="680" y="354.67" width="30" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-46" value="" style="endArrow=none;html=1;rounded=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" target="QN8Zc_zHYGFrYNp_f-iq-27">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="550" y="310" as="sourcePoint" />
            <mxPoint x="570" y="380" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="310" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-47" value="SYSCFG_CFGR1[1:0]" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="540" y="300" width="60" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-48" value="X0" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="593.13" y="324.67" width="16.87" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-49" value="01" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="593.13" y="339.67" width="16.87" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-50" value="11" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Courier New;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="593.13" y="354.67" width="16.87" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-51" value="CM0" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="484.67" y="327.33000000000004" width="35.33" height="35.33" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-52" value="" style="endArrow=classic;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" target="QN8Zc_zHYGFrYNp_f-iq-51">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="450" y="345" as="sourcePoint" />
            <mxPoint x="460" y="327.33" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-53" value="" style="verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.flash;fillColor=#FFFF66;" vertex="1" parent="1">
          <mxGeometry x="450" y="320" width="10" height="20" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-54" value="Look for IVT" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="525" y="349.67" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-64" value="BOOT&lt;br style=&quot;font-size: 8px;&quot;&gt;IVT" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="752.66" y="316.33" width="27.34" height="27.34" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-65" value="APP&lt;br style=&quot;font-size: 8px;&quot;&gt;IVT" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="752.66" y="346" width="27.34" height="27.34" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-68" value="" style="shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn0.iconfinder.com/data/icons/math-business-icon-set/93/1_9-128.png" vertex="1" parent="1">
          <mxGeometry x="521.25" y="390" width="10" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-69" value="Setup before any interrupt can occur" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="531.25" y="390" width="198.75" height="10" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-117" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="QN8Zc_zHYGFrYNp_f-iq-70" target="QN8Zc_zHYGFrYNp_f-iq-111">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="110" y="565" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-70" value="Reset Event" style="shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="545" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-71" value="Bootloader Region" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="150" y="510" width="140" height="490" as="geometry">
            <mxRectangle x="230" y="500" width="150" height="30" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-78" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="QN8Zc_zHYGFrYNp_f-iq-71" source="QN8Zc_zHYGFrYNp_f-iq-73" target="QN8Zc_zHYGFrYNp_f-iq-74">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-73" value="Setup System Clock" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="QN8Zc_zHYGFrYNp_f-iq-71">
          <mxGeometry x="25" y="110" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-79" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="QN8Zc_zHYGFrYNp_f-iq-71" source="QN8Zc_zHYGFrYNp_f-iq-74" target="QN8Zc_zHYGFrYNp_f-iq-75">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-74" value="Setup GPIO, UART, CAN" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="QN8Zc_zHYGFrYNp_f-iq-71">
          <mxGeometry x="25" y="190" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-80" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="QN8Zc_zHYGFrYNp_f-iq-71" source="QN8Zc_zHYGFrYNp_f-iq-75" target="QN8Zc_zHYGFrYNp_f-iq-76">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-75" value="Bootloader Logic" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="QN8Zc_zHYGFrYNp_f-iq-71">
          <mxGeometry x="25" y="270" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-81" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="QN8Zc_zHYGFrYNp_f-iq-71" source="QN8Zc_zHYGFrYNp_f-iq-76" target="QN8Zc_zHYGFrYNp_f-iq-77">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-76" value="Teardown Logic" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="QN8Zc_zHYGFrYNp_f-iq-71">
          <mxGeometry x="25" y="350" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-77" value="Set MSP to APP &amp;amp; Jump to Application" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="QN8Zc_zHYGFrYNp_f-iq-71">
          <mxGeometry x="25" y="430" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-112" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="QN8Zc_zHYGFrYNp_f-iq-71" source="QN8Zc_zHYGFrYNp_f-iq-111" target="QN8Zc_zHYGFrYNp_f-iq-73">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-111" value="data/bss/stack init" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="QN8Zc_zHYGFrYNp_f-iq-71">
          <mxGeometry x="25" y="30" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-84" value="Application Region" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="380" y="510" width="140" height="490" as="geometry">
            <mxRectangle x="460" y="500" width="150" height="30" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-97" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="QN8Zc_zHYGFrYNp_f-iq-84" source="QN8Zc_zHYGFrYNp_f-iq-86" target="QN8Zc_zHYGFrYNp_f-iq-96">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-86" value="Setup System Clock" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="QN8Zc_zHYGFrYNp_f-iq-84">
          <mxGeometry x="25" y="110" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-87" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="QN8Zc_zHYGFrYNp_f-iq-84" source="QN8Zc_zHYGFrYNp_f-iq-88" target="QN8Zc_zHYGFrYNp_f-iq-90">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-88" value="Setup GPIO, UART, I2C, CAN, SSD1306" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="QN8Zc_zHYGFrYNp_f-iq-84">
          <mxGeometry x="25" y="350" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-90" value="Application Logic" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="QN8Zc_zHYGFrYNp_f-iq-84">
          <mxGeometry x="25" y="430" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-95" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="QN8Zc_zHYGFrYNp_f-iq-84" source="QN8Zc_zHYGFrYNp_f-iq-94" target="QN8Zc_zHYGFrYNp_f-iq-88">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-94" value="Setup SYSCFG CLK and memboot" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="QN8Zc_zHYGFrYNp_f-iq-84">
          <mxGeometry x="25" y="270" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-98" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="QN8Zc_zHYGFrYNp_f-iq-84" source="QN8Zc_zHYGFrYNp_f-iq-96" target="QN8Zc_zHYGFrYNp_f-iq-94">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-96" value="Copy IVT to SRAM" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="QN8Zc_zHYGFrYNp_f-iq-84">
          <mxGeometry x="25" y="190" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-114" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="QN8Zc_zHYGFrYNp_f-iq-84" source="QN8Zc_zHYGFrYNp_f-iq-113" target="QN8Zc_zHYGFrYNp_f-iq-86">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-113" value="data/bss/stack init" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="QN8Zc_zHYGFrYNp_f-iq-84">
          <mxGeometry x="25" y="30" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-99" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="QN8Zc_zHYGFrYNp_f-iq-77" target="QN8Zc_zHYGFrYNp_f-iq-113">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-124" value="" style="curved=1;endArrow=classic;html=1;rounded=0;entryX=1;entryY=0;entryDx=0;entryDy=0;fillColor=#f8cecc;strokeColor=#b85450;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="380" y="510" as="sourcePoint" />
            <mxPoint x="290" y="510" as="targetPoint" />
            <Array as="points">
              <mxPoint x="340" y="490" />
              <mxPoint x="300" y="510" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-128" value="&lt;font style=&quot;font-size: 20px;&quot;&gt;x&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="QN8Zc_zHYGFrYNp_f-iq-124">
          <mxGeometry x="0.0344" y="3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-129" value="Implementation Notes on VT Relocation" style="swimlane;whiteSpace=wrap;html=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="575" y="420" width="230" height="240" as="geometry">
            <mxRectangle x="610" y="420" width="230" height="30" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-130" value="Main points (in chronological order):&lt;br&gt;1. Memory to be reserved for vector table in Linkerscript with the section defined.&amp;nbsp;&lt;br&gt;2. IVT needs to be copied from FLASH to SRAM.&lt;br&gt;3. SYSCFG_CFRG1 to be set.&amp;nbsp;&lt;br&gt;4. Ready to receive interrupt.&lt;br&gt;&lt;br&gt;There are many ways to achieve this.&lt;br&gt;&lt;br&gt;Option A (as per AN4065)&lt;br&gt;- Define new memory region in ld and add a new sector in that region (part of the RAM region)&lt;br&gt;- After mem init and system clock init, copy data into the SRAM region defined earlier in ld&lt;br&gt;- Enable clock gating to APB syscfg&lt;br&gt;- Set syscfg memboot to SRAM&lt;br&gt;&lt;br&gt;&lt;b&gt;Option B (IMPLEMENTED)&lt;br&gt;&lt;/b&gt;- On the existing SRAM region, define a region at the front of SRAM for Vector table. size 0xc0.&lt;br&gt;- Follow point 2,3,4 from above" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=8;" vertex="1" parent="QN8Zc_zHYGFrYNp_f-iq-129">
          <mxGeometry y="25" width="230" height="215" as="geometry" />
        </mxCell>
        <mxCell id="QN8Zc_zHYGFrYNp_f-iq-144" value="Why not copy the IVT in Bootloader?&lt;br&gt;- Then I will have to reserve the ram space in bootloader region too. If I can change the VTOR directly, then I would have changed in the bootloader region.&amp;nbsp;&lt;br&gt;Why not copy the APP stack to MSP in APP instead?&lt;br&gt;- I can but i have to do it in the reset handler before anything is pushed onto the stack. The reset handler is part of Libopencm3 source code and Im avoiding changing their library." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Verdana;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="550" y="740" width="275" height="120" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
